{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Cart=()=>{const[cart,setCart]=useState({});const[total,setTotal]=useState(0);useEffect(()=>{const loadCart=()=>{const stored=JSON.parse(localStorage.getItem(\"cart\"))||{};const now=Date.now();const FIFTEEN_MIN=15*60*1000;const filtered=Object.fromEntries(Object.entries(stored).filter(_ref=>{let[_,item]=_ref;return!item.timestamp||now-item.timestamp<FIFTEEN_MIN;}));setCart(filtered);};loadCart();// початково\nconst interval=setInterval(loadCart,1000);// оновлювати щосекунди\nwindow.addEventListener(\"focus\",loadCart);return()=>{clearInterval(interval);window.removeEventListener(\"focus\",loadCart);};},[]);useEffect(()=>{const interval=setInterval(()=>{const now=Date.now();const FIFTEEN_MIN=15*60*1000;const filtered=Object.fromEntries(Object.entries(cart).filter(_ref2=>{let[_,item]=_ref2;return!item.timestamp||now-item.timestamp<FIFTEEN_MIN;}));if(Object.keys(filtered).length!==Object.keys(cart).length){setCart(filtered);}},60000);// оновлювати щохвилини\nreturn()=>clearInterval(interval);},[cart]);useEffect(()=>{const sum=Object.values(cart).reduce((acc,item)=>acc+item.price*item.quantity,0);setTotal(sum);localStorage.setItem(\"cart\",JSON.stringify(cart));},[cart]);const updateQuantity=(title,quantity)=>{const updated={...cart};if(quantity<=0){delete updated[title];}else{updated[title].quantity=quantity;updated[title].timestamp=Date.now();}setCart(updated);localStorage.setItem(\"cart\",JSON.stringify(updated));};const checkout=()=>{if(Object.keys(cart).length===0)return;const orders=JSON.parse(localStorage.getItem(\"orders\"))||[];orders.push({date:new Date().toLocaleString(),items:{...cart}});localStorage.setItem(\"orders\",JSON.stringify(orders));alert(\"Дякуємо! Ваше замовлення оформлено.\");setCart({});localStorage.removeItem(\"cart\");};useEffect(()=>{const syncCartAcrossTabs=e=>{if(e.key===\"cart\"){const updatedCart=JSON.parse(e.newValue)||{};setCart(updatedCart);}};window.addEventListener(\"storage\",syncCartAcrossTabs);return()=>{window.removeEventListener(\"storage\",syncCartAcrossTabs);};},[]);console.log(\"Поточний кошик:\",cart);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u041A\\u043E\\u0448\\u0438\\u043A\"}),Object.keys(cart).length===0?/*#__PURE__*/_jsx(\"p\",{children:\"\\u0412\\u0430\\u0448 \\u043A\\u043E\\u0448\\u0438\\u043A \\u043F\\u043E\\u0440\\u043E\\u0436\\u043D\\u0456\\u0439.\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"ul\",{children:Object.entries(cart).map(_ref3=>{let[title,item]=_ref3;return/*#__PURE__*/_jsxs(\"li\",{children:[title,\" x\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",value:item.quantity,\"data-title\":title,className:\"cart-quantity\",onChange:e=>updateQuantity(title,parseInt(e.target.value))}),\"= \",item.price*item.quantity,\" \\u0433\\u0440\\u043D\"]},title);})}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0420\\u0430\\u0437\\u043E\\u043C: \",total,\" \\u0433\\u0440\\u043D\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:checkout,disabled:Object.keys(cart).length===0,children:\"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u0438 \\u0437\\u0430\\u043C\\u043E\\u0432\\u043B\\u0435\\u043D\\u043D\\u044F\"})]})]});};export default Cart;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","cart","setCart","total","setTotal","loadCart","stored","JSON","parse","localStorage","getItem","now","Date","FIFTEEN_MIN","filtered","Object","fromEntries","entries","filter","_ref","_","item","timestamp","interval","setInterval","window","addEventListener","clearInterval","removeEventListener","_ref2","keys","length","sum","values","reduce","acc","price","quantity","setItem","stringify","updateQuantity","title","updated","checkout","orders","push","date","toLocaleString","items","alert","removeItem","syncCartAcrossTabs","e","key","updatedCart","newValue","console","log","children","map","_ref3","type","min","value","className","onChange","parseInt","target","onClick","disabled"],"sources":["/Users/andrijzuk/AndriZhok.github.io/lab3R/bookstore/src/components/Cart.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nconst Cart = () => {\n  const [cart, setCart] = useState({});\n  const [total, setTotal] = useState(0);\n\n  useEffect(() => {\n    const loadCart = () => {\n      const stored = JSON.parse(localStorage.getItem(\"cart\")) || {};\n      const now = Date.now();\n      const FIFTEEN_MIN = 15 * 60 * 1000;\n\n      const filtered = Object.fromEntries(\n        Object.entries(stored).filter(([_, item]) => {\n          return !item.timestamp || now - item.timestamp < FIFTEEN_MIN;\n        })\n      );\n\n      setCart(filtered);\n    };\n\n    loadCart(); // початково\n\n    const interval = setInterval(loadCart, 1000); // оновлювати щосекунди\n\n    window.addEventListener(\"focus\", loadCart);\n\n    return () => {\n      clearInterval(interval);\n      window.removeEventListener(\"focus\", loadCart);\n    };\n  }, []);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = Date.now();\n      const FIFTEEN_MIN = 15 * 60 * 1000;\n      const filtered = Object.fromEntries(\n        Object.entries(cart).filter(([_, item]) => {\n          return !item.timestamp || now - item.timestamp < FIFTEEN_MIN;\n        })\n      );\n      if (Object.keys(filtered).length !== Object.keys(cart).length) {\n        setCart(filtered);\n      }\n    }, 60000); // оновлювати щохвилини\n\n    return () => clearInterval(interval);\n  }, [cart]);\n\n  useEffect(() => {\n    const sum = Object.values(cart).reduce(\n      (acc, item) => acc + item.price * item.quantity,\n      0\n    );\n    setTotal(sum);\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\n  }, [cart]);\n\n  const updateQuantity = (title, quantity) => {\n    const updated = { ...cart };\n    if (quantity <= 0) {\n      delete updated[title];\n    } else {\n      updated[title].quantity = quantity;\n      updated[title].timestamp = Date.now();\n    }\n    setCart(updated);\n    localStorage.setItem(\"cart\", JSON.stringify(updated));\n  };\n\n  const checkout = () => {\n    if (Object.keys(cart).length === 0) return;\n    const orders = JSON.parse(localStorage.getItem(\"orders\")) || [];\n    orders.push({ date: new Date().toLocaleString(), items: { ...cart } });\n    localStorage.setItem(\"orders\", JSON.stringify(orders));\n    alert(\"Дякуємо! Ваше замовлення оформлено.\");\n    setCart({});\n    localStorage.removeItem(\"cart\");\n  };\n\n  useEffect(() => {\n    const syncCartAcrossTabs = (e) => {\n      if (e.key === \"cart\") {\n        const updatedCart = JSON.parse(e.newValue) || {};\n        setCart(updatedCart);\n      }\n    };\n\n    window.addEventListener(\"storage\", syncCartAcrossTabs);\n\n    return () => {\n      window.removeEventListener(\"storage\", syncCartAcrossTabs);\n    };\n  }, []);\n\n  console.log(\"Поточний кошик:\", cart);\n\n  return (\n    <div>\n      <h1>Кошик</h1>\n      {Object.keys(cart).length === 0 ? (\n        <p>Ваш кошик порожній.</p>\n      ) : (\n        <>\n          <ul>\n            {Object.entries(cart).map(([title, item]) => (\n              <li key={title}>\n                {title} x\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  value={item.quantity}\n                  data-title={title}\n                  className=\"cart-quantity\"\n                  onChange={(e) =>\n                    updateQuantity(title, parseInt(e.target.value))\n                  }\n                />\n                = {item.price * item.quantity} грн\n              </li>\n            ))}\n          </ul>\n          <p>Разом: {total} грн</p>\n          <button onClick={checkout} disabled={Object.keys(cart).length === 0}>\n            Оформити замовлення\n          </button>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default Cart;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}